<!DOCTYPE html>
<html>
<head>
    <script src="js/face-api.js"></script>
    <script src="js/commons.js"></script>
    <script src="js/faceDetectionControls.js"></script>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.css">
    <link rel="stylesheet" href="live2d/css/live2d.css"/>
    <link rel="stylesheet" href="css/easyui.css"/>
    <link rel="stylesheet" type="text/css" href="css/util.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.easyui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>
<body style="background-color: #EBEEEF">

    <!--live2d Model-->

    <div id="landlord" style="position: absolute;left: 50px;top: 100px">
        <div class="message card-panel teal lighten-2" style="opacity:0"></div>
        <canvas id="live2d" height="500px" class="live2d"></canvas>
        <div id="hide-button" class="btn-floating btn-large waves-effect waves-light">hide</div>
    </div>

    <!--main body-->
    <div style="text-align: center; background-color: #EBEEEF">
    <div class="center-content page-container" >
        <div class="progress" id="loader">
            <div class="indeterminate"></div>
        </div>
        <div style="position: relative" class="margin">
            <video onloadedmetadata="onPlay(this)" id="inputVideo" autoplay muted playsinline></video>
            <canvas id="overlay" />
        </div>
        <div class="row side-by-side" style="display: none">
            <!-- face_detector_selection_control -->
            <div id="face_detector_selection_control" class="row input-field" style="margin-right: 20px; text-align: left">
                <select id="selectFaceDetector">
                    <option value="ssd_mobilenetv1">SSD Mobilenet V1</option>
                    <option value="tiny_face_detector">Tiny Face Detector</option>
                    <option value="mtcnn">MTCNN</option>
                </select>
                <label>Select Face Detector</label>
            </div>
            <!-- face_detector_selection_control -->

            <!-- check boxes -->
            <div class="row" style="width: 220px;text-align: left">
                <input type="checkbox" id="withFaceLandmarksCheckbox" onchange="onChangeWithFaceLandmarks(event)" />
                <label for="withFaceLandmarksCheckbox">Detect Face Landmarks</label>
                <input type="checkbox" id="hideBoundingBoxesCheckbox" onchange="onChangeHideBoundingBoxes(event)" />
                <label for="hideBoundingBoxesCheckbox">Hide Bounding Boxes</label>
            </div>
            <!-- check boxes -->

            <!-- fps_meter -->
            <div id="fps_meter" class="row side-by-side" style="text-align: left">
                <div>
                    <label for="time">Time:</label>
                    <input disabled value="-" id="time" type="text" class="bold">
                    <label for="fps">Estimated Fps:</label>
                    <input disabled value="-" id="fps" type="text" class="bold">
                </div>
            </div>
            <!-- fps_meter -->
        </div>

        <!-- ssd_mobilenetv1_controls -->
        <span id="ssd_mobilenetv1_controls" style="text-align: left;display: none">
          <div class="row side-by-side"  style="display: none">
            <div class="row">
              <label for="minConfidence">Min Confidence:</label>
              <input disabled value="0.5" id="minConfidence" type="text" class="bold">
            </div>
            <button
                    class="waves-effect waves-light btn"
                    onclick="onDecreaseMinConfidence()"
            >
              <i class="material-icons left">-</i>
            </button>
            <button
                    class="waves-effect waves-light btn"
                    onclick="onIncreaseMinConfidence()"
            >
              <i class="material-icons left">+</i>
            </button>
          </div>
        </span>
        <!-- ssd_mobilenetv1_controls -->

        <!-- tiny_face_detector_controls -->
        <span id="tiny_face_detector_controls" style="text-align: left;display: none">
          <div class="row side-by-side">
            <div class="row input-field" style="margin-right: 20px;">
              <select id="inputSize">
                <option value="" disabled selected>Input Size:</option>
                <option value="160">160 x 160</option>
                <option value="224">224 x 224</option>
                <option value="320">320 x 320</option>
                <option value="416">416 x 416</option>
                <option value="512">512 x 512</option>
                <option value="608">608 x 608</option>
              </select>
              <label>Input Size</label>
            </div>
            <div class="row">
              <label for="scoreThreshold">Score Threshold:</label>
              <input disabled value="0.5" id="scoreThreshold" type="text" class="bold">
            </div>
            <button
                    class="waves-effect waves-light btn"
                    onclick="onDecreaseScoreThreshold()"
            >
              <i class="material-icons left">-</i>
            </button>
            <button
                    class="waves-effect waves-light btn"
                    onclick="onIncreaseScoreThreshold()"
            >
              <i class="material-icons left">+</i>
            </button>
          </div>
        </span>
        <!-- tiny_face_detector_controls -->

        <!-- mtcnn_controls -->
        <span id="mtcnn_controls" style="text-align: left;display: none">
          <div class="row side-by-side">
            <div class="row">
              <label for="minFaceSize">Minimum Face Size:</label>
              <input disabled value="20" id="minFaceSize" type="text" class="bold">
            </div>
            <button
                    class="waves-effect waves-light btn"
                    onclick="onDecreaseMinFaceSize()"
            >
              <i class="material-icons left">-</i>
            </button>
            <button
                    class="waves-effect waves-light btn"
                    onclick="onIncreaseMinFaceSize()"
            >
              <i class="material-icons left">+</i>
            </button>
          </div>
        </span>
        <!-- mtcnn_controls -->

        <div style="text-align: left;display: none">
            <a class="waves-effect waves-light btn" href="video.html">
                <i class="material-icons">video test</i>
            </a>
        </div>

        <div style="margin-top: 2em">
            <label for="csiec">csiec:</label>
            <input id="csiec" disabled type="text"/>
            <label for="userwords" id="user">user</label>
            <input id="userwords" type="text"/>
        </div>

        <a class="btn-floating btn-large pulse" id="btnSend"><i class="material-icons">cloud</i></a>

        <btn class="btn-floating btn-large pulse" onclick="doc()"><i class="material-icons">cloud</i></btn>

        <audio id="audio" autoplay="autoplay"></audio>
    </div>
    </div>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="live2d/js/live2d.js"></script>
    <script type="text/javascript">
    let message_Path = './live2d/';
    </script>
    <script>
        var LAppDefine = {
            // 调试，true时会在console里显示日志
            DEBUG_LOG: true,
            DEBUG_MOUSE_LOG: true, // 鼠标相关日志
            //  全部设定
            //这里配置canvsa元素的id
            CANVAS_ID: "live2d",
            //是否开启滚轮缩放，默认true
            IS_SCROLL_SCALE: false,
            // 画面最大缩放级别
            VIEW_MAX_SCALE: 2,
            // 画面最小缩放级别
            VIEW_MIN_SCALE: 0.8,

            VIEW_LOGICAL_LEFT: -1,
            VIEW_LOGICAL_RIGHT: 1,

            VIEW_LOGICAL_MAX_LEFT: -2,
            VIEW_LOGICAL_MAX_RIGHT: 2,
            VIEW_LOGICAL_MAX_BOTTOM: -2,
            VIEW_LOGICAL_MAX_TOP: 2,

            // 动作优先级常量
            PRIORITY_NONE: 0,
            PRIORITY_IDLE: 1,
            PRIORITY_NORMAL: 2,
            PRIORITY_FORCE: 3,

            //是否绑定切换模型按钮
            IS_BIND_BUTTON: false,
            //绑定按钮元素id
            // BUTTON_ID : "Change",
            //是否开启模型切换完成之前禁止按钮点击的选项，默认为true
            // IS_BAN_BUTTON : true,
            //设置按钮禁止状态时的class，可自定义样式，前提是IS_BAN_BUTTON为true
            // BAN_BUTTON_CLASS : "inactive",
            //设置按钮正常状态时的class
            // NORMAL_BUTTON_CLASS : "active",
            //衣服切换模式 目前只支持两种 sequence-顺序 random-随机
            //需事先配置好json文件里的textures属性
            //暂不支持保存功能
            TEXURE_CHANGE_MODE: "sequence",
            IS_START_TEXURE_CHANGE: false,
            TEXURE_BUTTON_ID: "",
            /**
             *  模型定义
             自定义配置模型，同一数组内放置两个模型则为开启双模型
             三模型也只取数组里的前两个
             模型出现的顺序与数组一致
             这里请用相对路径配置
             */
            MODELS:
                [
                    ["live2d/model/live2d-widget-model-haruto/assets/haruto.model.json"]
                ],

            // 与外部定义的json文件匹配
            MOTION_GROUP_IDLE: "idle", // 空闲时
            // MOTION_GROUP_TAP_BODY : "tap_body", // 点击身体时
            // MOTION_GROUP_FLICK_HEAD : "flick_head", // 抚摸头部
            // MOTION_GROUP_PINCH_IN : "pinch_in", // 放大时
            // MOTION_GROUP_PINCH_OUT : "pinch_out", // 缩小时
            // MOTION_GROUP_SHAKE : "shake", // 摇晃
            //如果有自定义的动作分组可以放在这里

            // 与外部定义json文件相匹配
            // HIT_AREA_HEAD : "head",
            // HIT_AREA_BODY : "body",

            //初始化的模型大小
            SCALE: 1.0,
            //新增属性，是否播放音频 默认为true
            IS_PLAY_AUDIO: true,
            //新增属性，audio标签id值
            AUDIO_ID: "audio"
        };
        mgr = InitLive2D();
    </script>
    <script type="text/javascript" src="live2d/js/message.js"></script>
    <script type="text/javascript">
    $("#landlord").draggable();
    </script>
    <script type="text/javascript" src="js/faceRecognition.js"></script>
</body>
</html>